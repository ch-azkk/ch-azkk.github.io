<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>简历核心知识点 | AZのBLOG</title><meta name="description" content="简历知识点专业技能DDD架构与MVC架构DDD领域驱动设计是一种架构思想，主要为了解决MVC架构VO、PO腐化的问题  在MVC架构中，PO、VO与Service之间是互相调用的，也就是说可能一个VO被多个Service引用，但是每个Service中需要的属性可能略有差别，造成VO十分臃肿，并且属于哪个Service不明确，造成工程腐化，难以维护与迭代。而在DDD架构中，倾向于将工程拆分为一个个领"><meta name="keywords" content="DDD架构,MySQL,Redis,Seata,RabbitMQ"><meta name="author" content="AZ"><meta name="copyright" content="AZ"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/logo.png"><link rel="canonical" href="https://ch-azkk.github.io/posts/520504/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta property="og:type" content="article"><meta property="og:title" content="简历核心知识点"><meta property="og:url" content="https://ch-azkk.github.io/posts/520504/"><meta property="og:site_name" content="AZのBLOG"><meta property="og:description" content="简历知识点专业技能DDD架构与MVC架构DDD领域驱动设计是一种架构思想，主要为了解决MVC架构VO、PO腐化的问题  在MVC架构中，PO、VO与Service之间是互相调用的，也就是说可能一个VO被多个Service引用，但是每个Service中需要的属性可能略有差别，造成VO十分臃肿，并且属于哪个Service不明确，造成工程腐化，难以维护与迭代。而在DDD架构中，倾向于将工程拆分为一个个领"><meta property="og:image" content="https://ch-azkk.github.io/img/file.png"><meta property="article:published_time" content="2024-03-15T14:17:00.712Z"><meta property="article:modified_time" content="2024-04-07T15:06:44.949Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="prev" title="英语学习" href="https://ch-azkk.github.io/posts/520505/"><link rel="next" title="资源合集" href="https://ch-azkk.github.io/posts/520506/"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?82612d3ab63b5c010c299bdc15d48ffa";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2024-04-07 23:06:44'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile/Hexo/css/flink.min.css"><link rel="stylesheet" href="/css/modify.css"><link rel="stylesheet" href="/css/iconfont.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.0.0"></head><body><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">9</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">19</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://azkk.top/"><i class="fa-fw fa fa-desktop"></i><span> 社区</span></a></div><div class="menus_item"><a class="site-page" href="/box/"><i class="fa-fw fab fa-xbox"></i><span> 导航</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 媒体</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书单</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E5%8E%86%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">1.</span> <span class="toc-text">简历知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%93%E4%B8%9A%E6%8A%80%E8%83%BD"><span class="toc-number">1.1.</span> <span class="toc-text">专业技能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DDD%E6%9E%B6%E6%9E%84%E4%B8%8EMVC%E6%9E%B6%E6%9E%84"><span class="toc-number">1.1.1.</span> <span class="toc-text">DDD架构与MVC架构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DDD%E6%9E%B6%E6%9E%84%E5%88%86%E5%B1%82"><span class="toc-number">1.1.2.</span> <span class="toc-text">DDD架构分层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DDD%E9%A2%86%E5%9F%9F%E5%88%86%E5%B1%82"><span class="toc-number">1.1.3.</span> <span class="toc-text">DDD领域分层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring%E6%A0%B8%E5%BF%83"><span class="toc-number">1.1.4.</span> <span class="toc-text">Spring核心</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81Bean%E7%9A%84%E5%88%9B%E5%BB%BA%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">1、Bean的创建生命周期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81AOP%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="toc-number">1.1.4.2.</span> <span class="toc-text">2、AOP基本原理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86"><span class="toc-number">1.1.5.</span> <span class="toc-text">MySQL核心知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MyBatis%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86"><span class="toc-number">1.1.6.</span> <span class="toc-text">MyBatis核心知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86"><span class="toc-number">1.1.7.</span> <span class="toc-text">Redis核心知识</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RabbitMQ"><span class="toc-number">1.1.8.</span> <span class="toc-text">RabbitMQ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81%E6%B6%88%E6%81%AF%E5%8F%AF%E9%9D%A0%E6%80%A7%E4%BF%9D%E8%AF%81"><span class="toc-number">1.1.8.1.</span> <span class="toc-text">1、消息可靠性保证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81%E6%B6%88%E6%81%AF%E9%87%8D%E5%A4%8D%E6%B6%88%E8%B4%B9"><span class="toc-number">1.1.8.2.</span> <span class="toc-text">2、消息重复消费</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Seata"><span class="toc-number">1.1.9.</span> <span class="toc-text">Seata</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#XA"><span class="toc-number">1.1.9.1.</span> <span class="toc-text">XA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TA"><span class="toc-number">1.1.9.2.</span> <span class="toc-text">TA</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%82%E8%B0%88"><span class="toc-number">1.1.10.</span> <span class="toc-text">杂谈</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><header class="post-bg" id="page-header" style="background-image: url(/img/file.png)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">AZのBLOG</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://azkk.top/"><i class="fa-fw fa fa-desktop"></i><span> 社区</span></a></div><div class="menus_item"><a class="site-page" href="/box/"><i class="fa-fw fab fa-xbox"></i><span> 导航</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 媒体</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书单</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">简历核心知识点</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2024-03-15 22:17:00"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2024-03-15</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2024-04-07 23:06:44"><i class="fas fa-history fa-fw"></i> 更新于 2024-04-07</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/%E7%AE%80%E5%8E%86%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E7%82%B9/">简历核心知识点</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="简历知识点"><a href="#简历知识点" class="headerlink" title="简历知识点"></a>简历知识点</h1><h2 id="专业技能"><a href="#专业技能" class="headerlink" title="专业技能"></a>专业技能</h2><h3 id="DDD架构与MVC架构"><a href="#DDD架构与MVC架构" class="headerlink" title="DDD架构与MVC架构"></a>DDD架构与MVC架构</h3><p>DDD领域驱动设计是一种架构思想，主要为了解决MVC架构VO、PO腐化的问题</p>
<p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240301155810884.png" alt="image-20240301155810884"></p>
<p>在MVC架构中，PO、VO与Service之间是互相调用的，也就是说可能一个VO被多个Service引用，但是每个Service中需要的属性可能略有差别，造成VO十分臃肿，并且属于哪个Service不明确，造成工程腐化，难以维护与迭代。而在DDD架构中，倾向于将工程拆分为一个个领域，每个领域有相应的对象(值对象，实体对象，聚合对象)、Service服务和仓储服务，这样单个领域属于一个充血模型，对象属于属于哪个Service一目了然，各领域之间互不干扰，方便维护与迭代。但是MVC前期开发速度很快，相对来说DDD架构前期开发成本较高，比较适用于软件需要长期维护与迭代，如果软件只需要存活几年，则无需使用DDD架构。</p>
<h3 id="DDD架构分层"><a href="#DDD架构分层" class="headerlink" title="DDD架构分层"></a>DDD架构分层</h3><p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240301162323699.png" alt="image-20240301162323699"></p>
<ul>
<li><strong>接口定义 - xfg-frame-api</strong>：因为微服务中引用的 RPC 需要对外提供接口的描述信息，也就是调用方在使用的时候，需要引入 Jar 包，让调用方好能依赖接口的定义做代理。</li>
<li><strong>应用封装 - xfg-frame-app</strong>：这是应用启动和配置的一层，如一些 aop 切面或者 config 配置，以及打包镜像都是在这一层处理。你可以把它理解为专门为了启动服务而存在的。</li>
<li><strong>领域封装 - xfg-frame-domain</strong>：领域模型服务，是一个非常重要的模块。无论怎么做DDD的分层架构，domain 都是肯定存在的。在一层中会有一个个细分的领域服务，在每个服务包中会有【模型、仓库、服务】这样3部分。</li>
<li><strong>仓储服务 - xfg-frame-infrastructure</strong>：基础层依赖于 domain 领域层，因为在 domain 层定义了仓储接口需要在基础层实现。这是依赖倒置的一种设计方式，依赖倒置的处理方式也是为了让PO不暴露出去，做到防腐。</li>
<li><strong>领域封装 - xfg-frame-trigger</strong>：触发器层，一般也被叫做 adapter 适配器层。用于提供接口实现、消息接收、任务执行等。所以对于这样的操作，把它叫做触发器层。</li>
<li><strong>类型定义 - xfg-frame-types</strong>：通用类型定义层，在我们的系统开发中，会有很多类型的定义，包括；基本的 Response、Constants 和枚举。它会被其他的层进行引用使用。</li>
<li><strong>领域编排【可选】 - xfg-frame-case</strong>：领域编排层，一般对于较大且复杂的的项目，为了更好的防腐和提供通用的服务，一般会添加 case/application 层，用于对 domain 领域的逻辑进行封装组合处理（对领域进行编排）。</li>
</ul>
<h3 id="DDD领域分层"><a href="#DDD领域分层" class="headerlink" title="DDD领域分层"></a>DDD领域分层</h3><p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240301163743315.png" alt="image-20240301163743315"></p>
<ul>
<li>model 模型对象；<ul>
<li>aggreate：聚合对象，实体对象、值对象的协同组织，就是聚合对象。</li>
<li>entity：实体对象，大多数情况下，实体对象(Entity)与数据库持久化对象(PO)是1v1的关系，但也有为了封装一些属性信息，会出现1vn的关系。</li>
<li>valobj：值对象，通过对象属性值来识别的对象 </li>
</ul>
</li>
<li>repository 仓储服务；从数据库等数据源中获取数据，传递的对象可以是聚合对象、实体对象，返回的结果可以是；实体对象、值对象。因为仓储服务是由基础层(infrastructure) 引用领域层(domain)，是一种依赖倒置的结构，但它可以天然的隔离PO数据库持久化对象被引用。</li>
<li>service 服务设计；这里要注意，不要以为定义了聚合对象，就把超越1个对象以外的逻辑，都封装到聚合中，这会让你的代码后期越来越难维护。聚合更应该注重的是和本对象相关的单一简单封装场景，而把一些重核心业务方到 service 里实现。<strong>此外；如果你的设计模式应用不佳，那么无论是领域驱动设计、测试驱动设计还是换了三层和四层架构，你的工程质量依然会非常差。</strong></li>
</ul>
<blockquote>
<p>也就是说从MVC转为DDD，其实就相当于把空间归置好，让其变得整洁，知道衣服在什么地方，但衣服怎么叠还是涉及到代码质量的问题，所以在DDD中使用设计模式尤为重要，会使代码更清晰更好维护，如利用模板模式抽象整个流程，规则引擎过滤账号校验、策略模式包装不同类型的具体实现等等</p>
</blockquote>
<p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/road-map-ddd-08.png" alt="road-map-ddd-08"></p>
<h3 id="Spring核心"><a href="#Spring核心" class="headerlink" title="Spring核心"></a>Spring核心</h3><h4 id="1、Bean的创建生命周期"><a href="#1、Bean的创建生命周期" class="headerlink" title="1、Bean的创建生命周期"></a>1、Bean的创建生命周期</h4><p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240302233441921.png" alt="image-20240302233441921"></p>
<h4 id="2、AOP基本原理"><a href="#2、AOP基本原理" class="headerlink" title="2、AOP基本原理"></a>2、AOP基本原理</h4><p>初始化后如果对象需要经过AOP，则会创建一个代理对象，将生成的普通对象赋值给代理对象的target属性，也就是说生成的Bean就是这个代理对象，调用方法也是调用的代理对象的方法，当然代理对象也只是对功能进行增强，执行切面逻辑后需要调用target的对应方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Public <span class="keyword">class</span> <span class="title class_">UserService</span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> OrderServioce orderService;</span><br><span class="line">	</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Public <span class="keyword">class</span> <span class="title class_">UserServiceProxy</span> extend UserService&#123;<span class="comment">//CGLIB动态代理</span></span><br><span class="line">	<span class="keyword">private</span> UserService target;<span class="comment">//(将bean创建过程中生成的普通对象赋值给他)</span></span><br><span class="line">	</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="comment">//执行切面逻辑（例：@Before在执行原始对象方法前）</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//执行方法</span></span><br><span class="line">        target.test()；</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Public <span class="keyword">class</span> <span class="title class_">Main</span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserService userService;<span class="comment">//(将bean创建过程中生成的普通对象赋值给他)</span></span><br><span class="line">	</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="comment">//在这里的userService其实是代理对象</span></span><br><span class="line">        <span class="comment">//在处理切面逻辑没进入原始对象的test方法之前orderService等属性是为null的</span></span><br><span class="line">        userService.test();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><strong>代理对象</strong>：当使用AOP时，Spring会为目标对象创建一个代理对象。这个代理对象包含了目标对象以及切面的逻辑。当你调用代理对象的方法时，首先会执行切面的逻辑，然后再调用目标对象的方法。</li>
<li><strong>代理对象属性</strong>：虽然代理对象包含了目标对象的所有属性和方法，但代理对象本身并不直接持有目标对象的依赖对象（如OrderService）。因此，在代理对象内部直接访问这些依赖对象可能会导致空指针异常。但在实际执行目标对象的方法时，由于已经切换到了目标对象，所以可以正常访问这些依赖对象。</li>
</ol>
<blockquote>
<p>当然Spring的事务管理（@Transactional）也是通过AOP实现的，切面逻辑：</p>
<p>​    1.通过事务管理器开启DataSource连接                                                 2. 将conn.autoCommit置为false</p>
<p>​    3.执行方法，正常则执行conn.commit()，否则conn.rollback()          4. 将conn.autoCommit置为true</p>
</blockquote>
<h3 id="MySQL核心知识"><a href="#MySQL核心知识" class="headerlink" title="MySQL核心知识"></a>MySQL核心知识</h3><ul>
<li>MySQL事务并行执行可能出现的问题</li>
</ul>
<ol>
<li>脏读（一个事务可以读取到其他事务修改但未提交的数据）</li>
<li>不可重复读（事务执行过程中多次查询同一个数据是不一样的）</li>
<li>幻读（事务A进行对范围内的数据执行查询操作，此时事务B插入了一条数据，使得事务A多次查询数据集合不一致）</li>
</ol>
<ul>
<li><p>隔离级别</p>
<pre><code>1. 读未提交（会造成脏读、不可重复读、幻读）
1. 读已提交（会造成不可重复读、幻读）
1. 可重复读（会造成幻读，MYSQL默认隔离级别，InnoDB使用MVCC机制解决脏读和不可重复读问题，使用锁机制解决幻读问题）
1. 串行化（事务串行执行，效率最差安全性最高）</code></pre></li>
<li><p>事务原理</p>
</li>
</ul>
<blockquote>
<p>事务四大特性：A(原子性)、C(一致性)、I(隔离性)、D(持久性)，事务原理就是InnoDB怎么保证事务ACID特性</p>
</blockquote>
<ol>
<li>事务的原子性指的是事务执行的所有操作要么同时成功要么同时失败，在执行失败的时候事务需要回滚操作，主要是通过定义undo log日志实现的，undo log记录了数据在每个操作前的状态，如果事务执行过程中需要回滚，就可以根据undo log进行回滚操作</li>
<li>事务的一致性指的是数据从一个一致状态到另一个一致状态，主要是针对数据层面，而原子性更多指的是操作层面</li>
<li>事务的隔离性，MYSQL定义了四种隔离级别，默认为RR可重复读</li>
<li>事务的持久性指的是事务执行完成后必须写入磁盘做持久化，为了提高数据写入磁盘效率，事务执行后会将操作先写入redo log中，同时将数据写入Buffer Pool缓存中，定时读取redo log日志进行刷盘，同时数据库宕机了也通过redo log进行数据恢复。</li>
</ol>
<ul>
<li>索引</li>
</ul>
<blockquote>
<p>索引是一种提高数据库检索速度的数据结构，分为聚簇索引和非聚簇索引，底层由B+树实现，但索引并不是越多越好，因为在对数据进行修改的同时需要动态维护索引树，会造成额外开销</p>
</blockquote>
<ol>
<li>聚簇索引：主键就是一种聚簇索引，叶子节点上保存着整行记录</li>
<li>非聚簇索引：叶子节点上保存着主键ID，想要得到整行记录还需要通过主键ID进行回表操作，所以最好查询的信息覆盖索引，也就是说查询的字段在索引值上就可以获取得到，不用再执行回表操作，提高效率</li>
<li>联合索引：非聚簇索引，SQL语句想要走联合索引需要符合最左前缀原则，比如联合索引 age-name ，若SQL语句通过name作为条件查询，是没有办法走索引的，因为越过了age，不符合最左前缀原则，但如果用age作为条件或者age和name作为条件查询，则可以走索引（注意：只要符合最左前缀原则，SQL语句条件字段的顺序与索引顺序无关，InnoDB底层会自动优化成索引的顺序）</li>
</ol>
<h3 id="MyBatis核心知识"><a href="#MyBatis核心知识" class="headerlink" title="MyBatis核心知识"></a>MyBatis核心知识</h3><h3 id="Redis核心知识"><a href="#Redis核心知识" class="headerlink" title="Redis核心知识"></a>Redis核心知识</h3><blockquote>
<p><strong>Redis</strong> 有 6 种基础数据结构，它们分别是：<strong>string(字符串)</strong>、<strong>list(列表)</strong>、<strong>hash(字典)</strong>、<strong>set(集合)</strong> 、 <strong>zset(有序集合)</strong>和 <strong>Stream(流)</strong>。</p>
</blockquote>
<ul>
<li>持久化机制</li>
</ul>
<blockquote>
<p>Redis持久化机制主要有两种方式：RDB和AOF</p>
</blockquote>
<ol>
<li><p>RDB持久化是指在指定的时间间隔内将内存中的数据集以快照的方式写入磁盘，并保存到一个名为dump.rdb的二进制文件中，也是默认的持久化方式，它恢复时是将快照文件从磁盘直接读到内存里。</p>
<ul>
<li><p>save命令，以阻塞的方式进行RDB持久化</p>
</li>
<li><p>bgsave命令，会fork一个子进程来完成RDB的过程（阻塞fork这个动作），可以理解为Copy On Write机制，可能造成数据丢失</p>
</li>
<li><p>自动触发</p>
<blockquote>
<p>save 900 1              #在900秒(15分钟)之后，如果至少有1个key发生变化，则dump内存快照。</p>
<p>save 300 10            #在300秒(5分钟)之后，如果至少有10个key发生变化，则dump内存快照。</p>
<p>save 60 10000        #在60秒(1分钟)之后，如果至少有10000个key发生变化，则dump内存快照。</p>
</blockquote>
</li>
</ul>
</li>
<li><p>AOF日志是持续增量的备份，将Redis执行过的每个写操作以日志的形式记录下来(读操作不记录)，只许追加文件但不可以改写文件(appendonly.aof文件)。redis启动的时候会读取该文件进行数据恢复，根据日志文件的内容将写指令从前到后执行一次以完成数据的恢复工作。</p>
<ul>
<li><p>AOF重写机制：</p>
<blockquote>
<p>AOF是将每一个写操作记录到文件中，会造成AOF文件越来越大，当文件大小超过阈值时，需要对AOF文件进行重写，执行BGREWRITEAOF命令，Redis会维护一个AOF缓冲区用来记录重写过程中执行的写命令，当重写完成后会将缓冲区命令追加到重写后新的AOF文件中，最后用新的AOF文件替换旧的AOF文件</p>
</blockquote>
</li>
<li><p>AOF触发机制</p>
<blockquote>
<p>（1）每修改同步：appendfsync always   同步持久化，每次发生数据变更会被立即记录到磁盘，性能较差但数据完整性比较好。</p>
<p>（2）每秒同步：appendfsync everysec    异步操作，每秒记录，如果一秒内宕机，有数据丢失。</p>
<p>（3）不同步：appendfsync no   从不同步</p>
</blockquote>
</li>
</ul>
</li>
</ol>
<ul>
<li>过期删除策略——惰性＋定期</li>
</ul>
<ol>
<li>定时删除：给key设置过期时间的同时创建一个计时器，当key过期时立即删除</li>
<li>定期删除：每隔一段时间，随机挑选一些key进行检查，过期则删除</li>
<li>惰性删除：不主动检查key是否过期，而是在访问的时候先判断key是否过期，过期则删除</li>
</ol>
<blockquote>
<p>在执行SAVE命令或者BGSAVE命令创建一个新的RDB文件时，程序会对数据库中的键进行检查，已过期的键不会被保存到新创建的RDB文件中。如果数据库中的某个键已经过期，并且服务器开启了AOF持久化功能，当过期键被惰性删除或者定期删除后，程序会向AOF文件追加一条DEL命令，显式记录该键已被删除。</p>
</blockquote>
<ul>
<li>主从复制</li>
</ul>
<ol>
<li>全量同步</li>
</ol>
<p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310144245999.png" alt="image-20240310144245999"></p>
<p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310144409173.png" alt="image-20240310144409173"></p>
<p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310144853948.png" alt="image-20240310144853948"></p>
<ol start="2">
<li>增量同步</li>
</ol>
<p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310145454128.png" alt="image-20240310145454128"></p>
<p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310150235337.png" alt="image-20240310150235337"></p>
<ul>
<li><p>哨兵模式</p>
<p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310150743321.png" alt="image-20240310150743321"></p>
</li>
</ul>
<p>​    <img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310151008554.png" alt="image-20240310151008554"></p>
<p>​    <img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310151222677.png" alt="image-20240310151222677"></p>
<p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310151429592.png" alt="image-20240310151429592"></p>
<ul>
<li>缓存三大问题</li>
</ul>
<ol>
<li>缓存穿透：访问的数据在数据库和Redis中均不存在，通过缓存空对象（or 布隆过滤器）解决</li>
<li>缓存雪崩：同一时间大量key过期或Redis宕机，使得大量请求打到数据库，通过设置随机过期时间解决</li>
<li>缓存击穿：针对热点key过期，使得大量请求打到数据库，可以通过设置逻辑过期时间来解决，也就是不给热点key设置过期时间，当逻辑过期了，查询数据库进行缓存重建，但这段时间仍旧可以在Redis中请求到热点数据</li>
</ol>
<ul>
<li>Mysql与Redis的数据一致性保证</li>
</ul>
<ol>
<li>先删除缓存，再修改数据库（X）</li>
</ol>
<blockquote>
<p>如果先删除Redis缓存，此时还未来得及修改数据库，另一个线程就来读取数据，那么会把数据库中旧数据再写入到缓存中</p>
</blockquote>
<ol start="2">
<li>先修改数据库，再删除缓存（X）</li>
</ol>
<blockquote>
<p>如果先修改数据库，修改完成之后不幸线程挂掉了，导致缓存没有删除，那么下次线程读取的是旧缓存的数据</p>
</blockquote>
<ol start="3">
<li>延时双删 （✓）</li>
</ol>
<blockquote>
<p>先删除缓存，再操作数据库，待线程休眠XXX毫秒之后，再删除一次缓存</p>
<p>为什么要双删呢？</p>
<p>答：因为第一次删除的是还没更新前的数据，第二次删除则是因为读取的并发性导致的缓存重新写入数据出现的垃圾数据。</p>
</blockquote>
<h3 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h3><blockquote>
<p>RabbitMQ工作模式：<a target="_blank" rel="noopener" href="https://juejin.cn/post/6997217228743507981#heading-11">https://juejin.cn/post/6997217228743507981#heading-11</a></p>
</blockquote>
<h4 id="1、消息可靠性保证"><a href="#1、消息可靠性保证" class="headerlink" title="1、消息可靠性保证"></a>1、消息可靠性保证</h4><blockquote>
<p>MQ消息丢失可能有三种可能：1、生产者没有成功投递到MQ中；2、MQ自己把消息弄丢了；3、消费者未成功消费</p>
</blockquote>
<p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310193426427.png" alt="image-20240310193426427"></p>
<ul>
<li>生产者端：开启消息确认，Confirm模式，当MQ收到消息之后给生产者返回ack，在生产者中可以进行消息重传</li>
<li>MQ端：开启消息持久化，搭配生产者confirm机制，也就是将消息持久化之后再返回ack给生产者</li>
<li>消费者端：关闭MQ自动ack，当业务处理完毕再手动返回ack，MQ未收到ack即会再次把消息发给消费者消费</li>
</ul>
<h4 id="2、消息重复消费"><a href="#2、消息重复消费" class="headerlink" title="2、消息重复消费"></a>2、消息重复消费</h4><blockquote>
<p>在MQ中消息是无法保证不重复消费的，所以需要我们在业务中做幂等性保证，以下是几个思路：</p>
<ol>
<li>如果是直接写库的业务，先根据主键ID查询是否有这条记录，有则更新无则插入</li>
<li>如果是执行redis写操作，则天然就是幂等的</li>
<li>也可以传一个消息唯一ID过来，消费过则存入redis中，下次消息过来先判断消息ID在redis是否存在，无则消费</li>
</ol>
</blockquote>
<h3 id="Seata"><a href="#Seata" class="headerlink" title="Seata"></a>Seata</h3><h4 id="XA"><a href="#XA" class="headerlink" title="XA"></a>XA</h4><p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310210050660.png" alt="image-20240310210050660"></p>
<h4 id="TA"><a href="#TA" class="headerlink" title="TA"></a>TA</h4><p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310205215766.png" alt="image-20240310205215766"></p>
<p>会出现丢失更新，所以引入了全局锁，记录事务ID、表以及哪行记录，事务提交时需要获取全局锁，默认重试时间为10毫秒*30次</p>
<h3 id="杂谈"><a href="#杂谈" class="headerlink" title="杂谈"></a>杂谈</h3><p>OpenAI项目中SDK为什么用会话模型结构实现，因为通过工厂屏蔽使用细节，简化接口调用，像mybatis也是运用了这种结构，底层只有查和改两种操作（增删改都是改），但是通过会话工厂包装会话，提供增删改查四个接口，简化了接口调用，也方便用户调用。</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">AZ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://ch-azkk.github.io/posts/520504/">https://ch-azkk.github.io/posts/520504/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://ch-azkk.github.io" target="_blank">AZのBLOG</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/DDD%E6%9E%B6%E6%9E%84/">DDD架构</a><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a><a class="post-meta__tags" href="/tags/Redis/">Redis</a><a class="post-meta__tags" href="/tags/Seata/">Seata</a><a class="post-meta__tags" href="/tags/RabbitMQ/">RabbitMQ</a></div><div class="post_share"><div class="social-share" data-image="/img/project.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/520505/"><img class="prev-cover" data-src="/img/english.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">英语学习</div></div></a></div><div class="next-post pull-right"><a href="/posts/520506/"><img class="next-cover" data-src="/img/source.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">资源合集</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025  <i id="heartbeat" class="fa fas fa-heartbeat"></i> AZ</div><div class="framework-info"><span>驱动 </span><a target="_blank" rel="noopener" href="https://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></head></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script><script src="/js/calendar.js"></script><script src="/js/languages.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1.2,"jsonPath":"/live2dw/assets/hk416.model.json"},"display":{"width":200,"height":650,"position":"right","hOffset":0,"vOffset":-150},"mobile":{"show":true,"scale":0.5},"log":false});</script></body></html>