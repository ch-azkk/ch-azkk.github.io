<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Javaå¹¶å‘JUC | AZã®BLOG</title><meta name="description" content="Javaå¹¶å‘JUC1ã€è¿›ç¨‹ä¸çº¿ç¨‹  è¿›ç¨‹ï¼šç³»ç»Ÿè¿›è¡Œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½  ç‹­ä¹‰å®šä¹‰ï¼šè¿›ç¨‹æ˜¯æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„å®ä¾‹ å¹¿ä¹‰å®šä¹‰ï¼šè¿›ç¨‹æ˜¯ä¸€ä¸ªå…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç³»ç»Ÿå¯¹äºæŸä¸ªæ•°æ®é›†åˆçš„ä¸€ç§è¿è¡Œæ´»åŠ¨   çº¿ç¨‹ï¼šæ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œæ˜¯è¿›ç¨‹ä¸­çš„å®é™…è¿ä½œå•ä½    2ã€åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼ 2.1å®ç°Runnableæ¥å£æ¥åˆ›å»ºThreadçº¿ç¨‹  1234567891011121314151617"><meta name="keywords" content="JUC,Java"><meta name="author" content="AZ"><meta name="copyright" content="AZ"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/logo.png"><link rel="canonical" href="https://ch-azkk.github.io/posts/520502/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta property="og:type" content="article"><meta property="og:title" content="Javaå¹¶å‘JUC"><meta property="og:url" content="https://ch-azkk.github.io/posts/520502/"><meta property="og:site_name" content="AZã®BLOG"><meta property="og:description" content="Javaå¹¶å‘JUC1ã€è¿›ç¨‹ä¸çº¿ç¨‹  è¿›ç¨‹ï¼šç³»ç»Ÿè¿›è¡Œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½  ç‹­ä¹‰å®šä¹‰ï¼šè¿›ç¨‹æ˜¯æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„å®ä¾‹ å¹¿ä¹‰å®šä¹‰ï¼šè¿›ç¨‹æ˜¯ä¸€ä¸ªå…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç³»ç»Ÿå¯¹äºæŸä¸ªæ•°æ®é›†åˆçš„ä¸€ç§è¿è¡Œæ´»åŠ¨   çº¿ç¨‹ï¼šæ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œæ˜¯è¿›ç¨‹ä¸­çš„å®é™…è¿ä½œå•ä½    2ã€åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼ 2.1å®ç°Runnableæ¥å£æ¥åˆ›å»ºThreadçº¿ç¨‹  1234567891011121314151617"><meta property="og:image" content="https://ch-azkk.github.io/img/juc.png"><meta property="article:published_time" content="2024-03-15T15:54:19.293Z"><meta property="article:modified_time" content="2024-04-07T15:06:44.917Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="prev" title="PDFå¤„ç†å·¥å…·æ¨è" href="https://ch-azkk.github.io/posts/520503/"><link rel="next" title="è‹±è¯­å­¦ä¹ " href="https://ch-azkk.github.io/posts/520505/"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?82612d3ab63b5c010c299bdc15d48ffa";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  bookmark: {
    message_prev: 'æŒ‰',
    message_next: 'é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾'
  },
  runtime_unit: 'å¤©',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"æŒ‰","message_next":"é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾"},"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2024-04-07 23:06:44'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile/Hexo/css/flink.min.css"><link rel="stylesheet" href="/css/modify.css"><link rel="stylesheet" href="/css/iconfont.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.0.0"></head><body><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">8</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">19</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length_num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://azkk.top/"><i class="fa-fw fa fa-desktop"></i><span> ç¤¾åŒº</span></a></div><div class="menus_item"><a class="site-page" href="/box/"><i class="fa-fw fab fa-xbox"></i><span> å¯¼èˆª</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> åª’ä½“</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> ç”µå½±</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> ä¹¦å•</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Java%E5%B9%B6%E5%8F%91JUC"><span class="toc-number">1.</span> <span class="toc-text">Javaå¹¶å‘JUC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E8%BF%9B%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B"><span class="toc-number">1.1.</span> <span class="toc-text">1ã€è¿›ç¨‹ä¸çº¿ç¨‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.</span> <span class="toc-text">2ã€åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E5%B9%B6%E5%8F%91%E4%B8%8E%E5%B9%B6%E8%A1%8C"><span class="toc-number">1.3.</span> <span class="toc-text">3ã€å¹¶å‘ä¸å¹¶è¡Œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E7%94%A8%E6%88%B7%E7%BA%BF%E7%A8%8B%E4%B8%8E%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B"><span class="toc-number">1.4.</span> <span class="toc-text">4ã€ç”¨æˆ·çº¿ç¨‹ä¸å®ˆæŠ¤çº¿ç¨‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81synchronized%E7%9A%84%E4%BD%9C%E7%94%A8%E8%8C%83%E5%9B%B4"><span class="toc-number">1.5.</span> <span class="toc-text">5ã€synchronizedçš„ä½œç”¨èŒƒå›´</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81Lock%E9%94%81%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.6.</span> <span class="toc-text">6ã€Locké”æœºåˆ¶è¯¦è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1%E9%94%81%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1é”çš„ç±»å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2Lock%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2Lockæ¥å£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3Condition%E7%B1%BB%E5%AE%9E%E7%8E%B0%E7%AD%89%E5%BE%85-%E9%80%9A%E7%9F%A5"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3Conditionç±»å®ç°ç­‰å¾…&#x2F;é€šçŸ¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4ReentrantLock-%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81"><span class="toc-number">1.6.4.</span> <span class="toc-text">6.4ReentrantLock(å¯é‡å…¥é”)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5ReadWriteLock%E8%AF%BB%E5%86%99%E9%94%81"><span class="toc-number">1.6.5.</span> <span class="toc-text">6.5ReadWriteLockè¯»å†™é”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6synchronized%E4%B8%8ELock%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.6.6.</span> <span class="toc-text">6.6synchronizedä¸Lockçš„åŒºåˆ«</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81%E9%9B%86%E5%90%88%E7%9A%84%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98"><span class="toc-number">1.7.</span> <span class="toc-text">7ã€é›†åˆçš„çº¿ç¨‹å®‰å…¨é—®é¢˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81Callable%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.8.</span> <span class="toc-text">8ã€Callableæ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1Callable%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1Callableæ¥å£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2Future%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.8.2.</span> <span class="toc-text">8.2Futureæ¥å£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3FutureTask"><span class="toc-number">1.8.3.</span> <span class="toc-text">8.3FutureTask</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><header class="post-bg" id="page-header" style="background-image: url(/img/juc.png)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">AZã®BLOG</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://azkk.top/"><i class="fa-fw fa fa-desktop"></i><span> ç¤¾åŒº</span></a></div><div class="menus_item"><a class="site-page" href="/box/"><i class="fa-fw fab fa-xbox"></i><span> å¯¼èˆª</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> åª’ä½“</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> ç”µå½±</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> ä¹¦å•</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> éŸ³ä¹</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> å…³äº</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Javaå¹¶å‘JUC</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="å‘è¡¨äº 2024-03-15 23:54:19"><i class="far fa-calendar-alt fa-fw"></i> å‘è¡¨äº 2024-03-15</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="æ›´æ–°äº 2024-04-07 23:06:44"><i class="fas fa-history fa-fw"></i> æ›´æ–°äº 2024-04-07</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/JAVA%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">JAVAå¹¶å‘ç¼–ç¨‹</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="Javaå¹¶å‘JUC"><a href="#Javaå¹¶å‘JUC" class="headerlink" title="Javaå¹¶å‘JUC"></a>Javaå¹¶å‘JUC</h1><h2 id="1ã€è¿›ç¨‹ä¸çº¿ç¨‹"><a href="#1ã€è¿›ç¨‹ä¸çº¿ç¨‹" class="headerlink" title="1ã€è¿›ç¨‹ä¸çº¿ç¨‹"></a>1ã€è¿›ç¨‹ä¸çº¿ç¨‹</h2><blockquote>
<ul>
<li><p>è¿›ç¨‹ï¼šç³»ç»Ÿè¿›è¡Œç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½</p>
<ul>
<li>ç‹­ä¹‰å®šä¹‰ï¼šè¿›ç¨‹æ˜¯æ­£åœ¨è¿è¡Œçš„ç¨‹åºçš„å®ä¾‹</li>
<li>å¹¿ä¹‰å®šä¹‰ï¼šè¿›ç¨‹æ˜¯ä¸€ä¸ªå…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç³»ç»Ÿå¯¹äºæŸä¸ªæ•°æ®é›†åˆçš„ä¸€ç§è¿è¡Œæ´»åŠ¨</li>
</ul>
</li>
<li><p>çº¿ç¨‹ï¼šæ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ï¼Œæ˜¯è¿›ç¨‹ä¸­çš„å®é™…è¿ä½œå•ä½</p>
</li>
</ul>
</blockquote>
<h2 id="2ã€åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼"><a href="#2ã€åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼" class="headerlink" title="2ã€åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼"></a>2ã€åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼</h2><blockquote>
<p>2.1å®ç°Runnableæ¥å£æ¥åˆ›å»ºThreadçº¿ç¨‹</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TheardCreateDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Runnable</span> <span class="variable">runnable</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SomeRunnable</span>();</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(runnable);</span><br><span class="line">        thread1.start();</span><br><span class="line">        <span class="comment">//lamdaè¡¨è¾¾å¼æ–¹å¼</span></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">thread2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ä½¿ç”¨lamdaè¡¨è¾¾å¼æ–¹å¼&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        thread2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SomeRunnable</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(Thread.currentThread().getName()+<span class="string">&quot;:: é€šè¿‡å®ç°Runnableæ¥å£æ¥åˆ›å»ºThreadçº¿ç¨‹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.2ç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TheardCreateDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SomeThread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SomeThread</span>();</span><br><span class="line">        thread.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SomeThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é€šè¿‡ç»§æ‰¿Threadç±»æ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>2.3å®ç°Callableæ¥å£æ¥åˆ›å»ºThreadçº¿ç¨‹ï¼Œé€šè¿‡FutureTaskå¯ä»¥è·å–çº¿ç¨‹è¿”å›å€¼</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TheardCreateDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;</span><br><span class="line">        </span><br><span class="line">        FutureTask&lt;Object&gt; futureTask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;Object&gt;(<span class="keyword">new</span> <span class="title class_">SomeCallable</span>&lt;Object&gt;());</span><br><span class="line">        <span class="type">Thread</span> <span class="variable">oneThread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask);</span><br><span class="line">        </span><br><span class="line">        oneThread.start();</span><br><span class="line">        <span class="comment">// è¿™é‡Œå¯ä»¥åœ¨è¿è¡Œä¹‹åè·å¾— è¿”å›å€¼</span></span><br><span class="line">        System.out.println(futureTask.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SomeCallable</span>&lt;Object&gt; <span class="keyword">implements</span> <span class="title class_">Callable</span>&lt;Object&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;é€šè¿‡å®ç°Callableæ¥å£æ¥åˆ›å»ºThreadçº¿ç¨‹&quot;</span>);</span><br><span class="line">        <span class="comment">// è¿™ä¸ªæ˜¯å¯ä»¥è¿”å›æ•°æ®çš„ è¿™é‡Œå°±éšä¾¿è¿”å›ä¸ª 1024 å“ˆ</span></span><br><span class="line">        <span class="keyword">return</span> (Object)<span class="string">&quot; è¿™ä¸ªæ˜¯å¯ä»¥è¿”å›æ•°æ®çš„ è¿™é‡Œå°±éšä¾¿è¿”å›ä¸ªå“ˆ&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3ã€å¹¶å‘ä¸å¹¶è¡Œ"><a href="#3ã€å¹¶å‘ä¸å¹¶è¡Œ" class="headerlink" title="3ã€å¹¶å‘ä¸å¹¶è¡Œ"></a>3ã€å¹¶å‘ä¸å¹¶è¡Œ</h2><ul>
<li><p>å¹¶è¡Œï¼šå½“ç³»ç»Ÿæœ‰ä¸€ä¸ªæ ¸ä»¥ä¸ŠCPUæ—¶ï¼Œå¤šä¸ªCPUæ‰§è¡Œä¸åŒçš„è¿›ç¨‹ï¼Œäº’ä¸æŠ¢å èµ„æºï¼Œå¯ä»¥åŒæ—¶è¿›è¡Œï¼Œç§°ä¸ºå¹¶è¡Œ</p>
</li>
<li><p>å¹¶å‘ï¼šåŒä¸€å¤„ç†å™¨åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œé€šè¿‡ä¸Šä¸‹æ–‡å¿«é€Ÿåˆ‡æ¢è¥é€ ä¸€ç§åŒæ—¶è¿è¡Œå¤šä¸ªè¿›ç¨‹çš„å‡è±¡</p>
</li>
</ul>
<h2 id="4ã€ç”¨æˆ·çº¿ç¨‹ä¸å®ˆæŠ¤çº¿ç¨‹"><a href="#4ã€ç”¨æˆ·çº¿ç¨‹ä¸å®ˆæŠ¤çº¿ç¨‹" class="headerlink" title="4ã€ç”¨æˆ·çº¿ç¨‹ä¸å®ˆæŠ¤çº¿ç¨‹"></a>4ã€ç”¨æˆ·çº¿ç¨‹ä¸å®ˆæŠ¤çº¿ç¨‹</h2><ul>
<li>ç”¨æˆ·çº¿ç¨‹ï¼šé»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬åˆ›å»ºçš„çº¿ç¨‹æˆ–çº¿ç¨‹æ± éƒ½æ˜¯ç”¨æˆ·çº¿ç¨‹ï¼Œæ‰€ä»¥ç”¨æˆ·çº¿ç¨‹ä¹Ÿè¢«ç§°ä¹‹ä¸ºæ™®é€šçº¿ç¨‹</li>
<li>å®ˆæŠ¤çº¿ç¨‹ï¼šåœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™åœ¨åå°æä¾›ä¸€ç§é€šç”¨æœåŠ¡çš„çº¿ç¨‹ï¼ŒæœåŠ¡äºç”¨æˆ·çº¿ç¨‹ï¼Œå½“ç¨‹åºä¸­çš„ç”¨æˆ·çº¿ç¨‹å…¨éƒ¨æ‰§      è¡Œç»“æŸä¹‹åï¼Œå®ˆæŠ¤çº¿ç¨‹ä¹Ÿä¼šéšä¹‹ç»“æŸ</li>
</ul>
<h2 id="5ã€synchronizedçš„ä½œç”¨èŒƒå›´"><a href="#5ã€synchronizedçš„ä½œç”¨èŒƒå›´" class="headerlink" title="5ã€synchronizedçš„ä½œç”¨èŒƒå›´"></a>5ã€synchronizedçš„ä½œç”¨èŒƒå›´</h2><blockquote>
<p>synchronizedæ˜¯Javaä¸­çš„å…³é”®å­—ï¼Œæ˜¯ä¸€ç§åŒæ­¥é”</p>
</blockquote>
<p>1ã€ä¿®é¥°æŸä¸€å¤„ä»£ç å—ï¼Œè¢«ä¿®é¥°çš„ä»£ç å—ç§°ä¸ºåŒæ­¥è¯­å¥å—ã€‚ä½œç”¨èŒƒå›´æ˜¯{}ä¹‹é—´ï¼Œä½œç”¨çš„å¯¹è±¡æ˜¯è°ƒç”¨è¯¥ä»£ç å—çš„å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> (<span class="built_in">this</span>)&#123;</span><br><span class="line">	System.out.println(<span class="string">&quot;åŒæ­¥ä»£ç å— &quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€ä¿®é¥°åœ¨æ–¹æ³•ä¸Šï¼Œè¢«ä¿®é¥°çš„æ–¹æ³•ç§°ä¸ºåŒæ­¥æ–¹æ³•ã€‚ä½œç”¨èŒƒå›´æ˜¯æ•´ä¸ªæ–¹æ³•ï¼Œä½œç”¨å¯¹è±¡æ˜¯è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">sale</span><span class="params">()</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ï¼æ³¨ï¼šsynchronizedå…³é”®å­—ä¸èƒ½è¢«ç»§æ‰¿ï¼Œå¦‚æœçˆ¶ç±»ä¸­æŸæ–¹æ³•ä½¿ç”¨äº†synchronizedå…³é”®å­—ï¼Œå­ç±»åˆæ­£å·§è¦†ç›–äº†ï¼Œæ­¤æ—¶å­ç±»è¯¥æ–¹æ³•é»˜è®¤æ˜¯ä¸åŒæ­¥çš„ï¼Œå¿…é¡»æ˜¾ç¤ºåœ¨å­ç±»çš„æ–¹æ³•ä¸ŠåŠ ä¸Šæ‰å¯ã€‚å½“ç„¶ï¼Œå¦‚æœåœ¨å­ç±»æ–¹æ³•ä¸­è°ƒç”¨çˆ¶ç±»ä¸­çš„åŒæ­¥æ–¹æ³•ï¼Œè™½ç„¶å­ç±»æ²¡æœ‰åŒæ­¥æ–¹æ³•ï¼Œä½†è°ƒç”¨çˆ¶ç±»çš„åŒæ­¥æ–¹æ³•ä¹Ÿç›¸å½“äºåŒæ­¥äº†ã€‚</p>
</blockquote>
<p>3ã€ä¿®é¥°é™æ€æ–¹æ³•ï¼Œä½œç”¨èŒƒå›´æ˜¯æ•´ä¸ªé™æ€æ–¹æ³•ï¼Œä½œç”¨å¯¹è±¡æ˜¯è¯¥ç±»çš„æ‰€æœ‰å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4ã€ä¿®é¥°æŸä¸ªç±»ï¼Œå…¶ä½œç”¨èŒƒå›´æ˜¯synchronizedåé¢æ‹¬å·ä¸­çš„éƒ¨åˆ†ï¼Œä½œç”¨å¯¹è±¡æ˜¯è¯¥ç±»çš„æ‰€æœ‰å¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Ticket</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sale</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (Ticket.class) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5ã€æ¡ˆä¾‹(saleæ–¹æ³•è¢«synchronizedå…³é”®å­—ä¿®é¥°ï¼Œæ‰€ä»¥çº¿ç¨‹è°ƒç”¨saleæ–¹æ³•éœ€è¦ç­‰ä¸Šä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾é”)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SynchronizedDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Ticket</span> <span class="variable">ticket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Ticket</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">40</span>; i++) &#123;</span><br><span class="line">                ticket.sale();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="string">&quot;A&quot;</span>).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">40</span>; i++) &#123;</span><br><span class="line">                ticket.sale();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="string">&quot;B&quot;</span>).start();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">40</span>; i++) &#123;</span><br><span class="line">                ticket.sale();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="string">&quot;C&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Ticket</span> &#123;</span><br><span class="line">    <span class="comment">//ç¥¨æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">number</span> <span class="operator">=</span> <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ“ä½œæ–¹æ³•ï¼šå–ç¥¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">sale</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­ï¼šæ˜¯å¦æœ‰ç¥¨</span></span><br><span class="line">        <span class="keyword">if</span> (number &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; : &quot;</span> + (number--) + <span class="string">&quot; &quot;</span> + number);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>6ã€æ€»ç»“</p>
<p>synchronized çš„åŒæ­¥æ•ˆç‡éå¸¸ä½ï¼Œå› ä¸ºä¸€ä¸ªå¦‚æœæŸä¸€å—ä»£ç è¢«synchronized ä¿®é¥°äº†ï¼Œå½“æŸä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº†synchronized ä¿®é¥°çš„ä»£ç å—ï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹åªèƒ½ä¸€ç›´ç­‰å¾…ï¼Œç­‰å¾…è·å–é”çš„çº¿ç¨‹é‡Šæ”¾é”ï¼Œæ‰èƒ½è¿›å…¥å†æ¬¡è¿›å…¥åŒæ­¥ä»£ç å—ã€‚</p>
<p>è·å–é”çš„çº¿ç¨‹é‡Šæ”¾é”çš„æƒ…å†µåªæœ‰ä¸¤ç§ï¼š</p>
<ol>
<li>æ­£å¸¸æ‰§è¡Œå®Œï¼Œç„¶åé‡Šæ”¾é”ã€‚</li>
<li>æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå‘ç”Ÿå¼‚å¸¸ï¼ŒJVMè®©çº¿ç¨‹è‡ªåŠ¨é‡Šæ”¾é”ã€‚</li>
</ol>
<p>é‚£ä¹ˆä½ è¯•æƒ³ä¸€ä¸ªå¦‚æœè·å–åˆ°é”çš„è¿™ä¸ªçº¿ç¨‹ï¼Œç”±äºä¸€äº›ç­‰å¾…ï¼©ï¼¯åŸå› æˆ–å…¶ä»–åŸå› è¢«å µä½äº†ï¼Œä½†æ˜¯åˆä¸èƒ½é‡Šæ”¾é”ï¼Œå…¶ä»–çº¿ç¨‹å°±åªèƒ½åœ¨synchronizedçš„é—¨å£çœ‹ç€å•¦ï¼Œä½ æƒ³ä¸€ä¸‹è¿™ä¸ªæ•ˆç‡å§ï¼Œå‡ºç°ä¸€æ¬¡ï¼Œå¯èƒ½å°±æŠŠäººå¿ƒæ€ç©æ²¡å•¦å“ˆã€‚ğŸ˜‚</p>
<p>å› æ­¤éå¸¸éœ€è¦æœ‰ä¸€ç§æœºåˆ¶èƒ½å¤Ÿä¸è®©ç­‰å¾…çš„çº¿ç¨‹ä¸€ç›´æ— é™æœŸçš„ç­‰å¾…ä¸‹å»ï¼Œæ¯”å¦‚æ”¹æˆç­‰å¾…ä¸€æ®µæ—¶é—´æˆ–è€…å“åº”ä¸­æ–­ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡Lockæ¥åšè¿™ä»¶äº‹æƒ…ã€‚</p>
<h2 id="6ã€Locké”æœºåˆ¶è¯¦è§£"><a href="#6ã€Locké”æœºåˆ¶è¯¦è§£" class="headerlink" title="6ã€Locké”æœºåˆ¶è¯¦è§£"></a>6ã€Locké”æœºåˆ¶è¯¦è§£</h2><blockquote>
<p>æ˜¾å¼é”ï¼Œå®Œå…¨ç”¨Javaå†™æˆï¼Œåœ¨Javaè¿™ä¸ªå±‚é¢ä¸Šæ˜¯æ— å…³JVMå®ç°çš„ã€‚è™½ç„¶Lockç¼ºå°‘äº†(synchronizedå—æˆ–è€…æ–¹æ³•æ‰€æä¾›çš„)éšå¼è·å–/é‡Šæ”¾é”çš„ä¾¿æ·æ€§ï¼Œä½†æ˜¯å´æ‹¥æœ‰äº†é”è·å–ä¸é‡Šæ”¾çš„å¯æ“ä½œæ€§ã€å¯ä¸­æ–­è·å–é”ä»¥åŠè¶…æ—¶è·å–é”ç­‰å¤šç§synchronizedå…³é”®å­—ä¸å…·å¤‡çš„åŒæ­¥ç‰¹æ€§ã€‚</p>
</blockquote>
<h3 id="6-1é”çš„ç±»å‹"><a href="#6-1é”çš„ç±»å‹" class="headerlink" title="6.1é”çš„ç±»å‹"></a>6.1é”çš„ç±»å‹</h3><ul>
<li>å¯é‡å…¥é”ï¼šåœ¨æ‰§è¡Œå¯¹è±¡ä¸­æ‰€æœ‰åŒæ­¥æ–¹æ³•ä¸ç”¨å†æ¬¡è·å¾—é”</li>
<li>å¯ä¸­æ–­é”ï¼šåœ¨ç­‰å¾…è·å–é”çš„è¿‡ç¨‹ä¸­å¯ä¸­æ–­</li>
<li>å…¬å¹³é”ï¼šæŒ‰ç…§è¯·æ±‚è·å–é”çš„é¡ºåºè¿›è¡Œè·å–ï¼Œå³ç­‰å¾…æ—¶é—´é•¿çš„å…·æœ‰ä¼˜å…ˆè·å–é”çš„æƒåŠ›</li>
<li>è¯»å†™é”ï¼šå¯¹èµ„æºè¯»å–å’Œå†™å…¥çš„æ—¶å€™æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†å¤„ç†<ul>
<li>è¯»é”ä¸ºå…±äº«é”ï¼Œè¯»çš„æ—¶å€™å¯ä»¥å¤šçº¿ç¨‹ä¸€èµ·è¯»</li>
<li>å†™é”ä¸ºæ’å®ƒé”(ç‹¬å é”)ï¼Œå†™çš„æ—¶å€™å¿…é¡»åŒæ­¥çš„å†™</li>
</ul>
</li>
</ul>
<h3 id="6-2Lockæ¥å£"><a href="#6-2Lockæ¥å£" class="headerlink" title="6.2Lockæ¥å£"></a>6.2Lockæ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Lock</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">lock</span><span class="params">()</span>; <span class="comment">//è·å¾—é”ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    é™¤éå½“å‰çº¿ç¨‹è¢«ä¸­æ–­ï¼Œå¦åˆ™è·å–é”ã€‚</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">	å¦‚æœå¯ç”¨ï¼Œåˆ™è·å–é”å¹¶ç«‹å³è¿”å›ã€‚</span></span><br><span class="line"><span class="comment">	å¦‚æœé”ä¸å¯ç”¨ï¼Œåˆ™å½“å‰çº¿ç¨‹å°†å‡ºäºçº¿ç¨‹è°ƒåº¦ç›®çš„è€Œè¢«ç¦ç”¨å¹¶å¤„äºä¼‘çœ çŠ¶æ€ï¼Œç›´åˆ°å‘ç”Ÿä»¥ä¸‹ä¸¤ç§æƒ…å†µä¹‹ä¸€ï¼š</span></span><br><span class="line"><span class="comment">		é”è¢«å½“å‰çº¿ç¨‹è·å–ï¼› </span></span><br><span class="line"><span class="comment">		è¦ä¹ˆå…¶ä»–ä¸€äº›çº¿ç¨‹ä¸­æ–­å½“å‰çº¿ç¨‹ï¼Œæ”¯æŒä¸­æ–­è·å–é”ã€‚</span></span><br><span class="line"><span class="comment">	å¦‚æœå½“å‰çº¿ç¨‹ï¼š</span></span><br><span class="line"><span class="comment">		åœ¨è¿›å…¥æ­¤æ–¹æ³•æ—¶è®¾ç½®å…¶ä¸­æ–­çŠ¶æ€ï¼› </span></span><br><span class="line"><span class="comment">		è¦ä¹ˆè·å–é”æ—¶ä¸­æ–­ï¼Œæ”¯æŒä¸­æ–­è·å–é”ï¼Œ</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">lockInterruptibly</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException; </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    ä»…åœ¨è°ƒç”¨æ—¶ç©ºé—²æ—¶æ‰è·å–é”ã€‚</span></span><br><span class="line"><span class="comment">	å¦‚æœå¯ç”¨ï¼Œåˆ™è·å–é”å¹¶ç«‹å³è¿”å›å€¼ä¸ºtrue ã€‚ å¦‚æœé”ä¸å¯ç”¨ï¼Œåˆ™æ­¤æ–¹æ³•å°†ç«‹å³è¿”å›falseå€¼ã€‚</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">tryLock</span><span class="params">()</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//æ¯”ä¸Šé¢å¤šä¸€ä¸ªç­‰å¾…æ—¶é—´ </span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">tryLock</span><span class="params">(<span class="type">long</span> time, TimeUnit unit)</span> <span class="keyword">throws</span> InterruptedException;  </span><br><span class="line"></span><br><span class="line">   	<span class="comment">// è§£é”</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">unlock</span><span class="params">()</span>; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è¿”å›ç»‘å®šåˆ°æ­¤Lockå®ä¾‹çš„æ–°Conditionå®ä¾‹ã€‚</span></span><br><span class="line">    Condition <span class="title function_">newCondition</span><span class="params">()</span>;  ã€‚</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1ã€lock()æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ä¹‹ä¸€ï¼Œä½œç”¨å°±æ˜¯è·å–é”ï¼Œå¦‚æœé”å·²ç»è¢«å…¶ä»–çº¿ç¨‹è·å–ï¼Œåˆ™å½“å‰çº¿ç¨‹å°†è¢«ç¦ç”¨ä»¥è¿›è¡Œçº¿ç¨‹è°ƒåº¦ï¼Œå¹¶å¤„äºä¼‘çœ çŠ¶æ€ï¼Œç­‰å¾…ï¼Œç›´åˆ°è·å–é”ã€‚</p>
<blockquote>
<p><strong>ï¼æ³¨ï¼šä½¿ç”¨lockçš„è¯ï¼Œä¸ç®¡æœ‰æ²¡æœ‰å‘ç”Ÿå¼‚å¸¸ï¼Œéƒ½å¿…é¡»å»ä¸»åŠ¨é‡Šæ”¾é”ï¼Œå› ä¸ºlockå¹¶ä¸ä¼šåƒsynchronizedä¸€æ ·è¢«è‡ªåŠ¨é‡Šæ”¾ã€‚æ‰€ä»¥ä½¿ç”¨lockçš„è¯ï¼Œå¿…é¡»æ˜¯åœ¨try{}catch{}ä¸­è¿›è¡Œï¼Œå¹¶å°†é‡Šæ”¾é”çš„æ“ä½œunlock()æ”¾åœ¨finally{}ä»£ç å—ä¸­ï¼Œç¡®ä¿é”ä¸€å®šä¼šè¢«é‡Šæ”¾ï¼Œé¿å…å‘ç”Ÿæ­»é”çš„ç°è±¡ã€‚</strong></p>
</blockquote>
<p>2ã€unlock()çš„ä½œç”¨å°±æ˜¯ä¸»åŠ¨é‡Šæ”¾é”</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Lock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    lock.lock();</span><br><span class="line">    System.out.println(<span class="string">&quot;ä¸Šé”äº†&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">    lock.unlock();</span><br><span class="line">    System.out.println(<span class="string">&quot;è§£é”äº†&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-3Conditionç±»å®ç°ç­‰å¾…-é€šçŸ¥"><a href="#6-3Conditionç±»å®ç°ç­‰å¾…-é€šçŸ¥" class="headerlink" title="6.3Conditionç±»å®ç°ç­‰å¾…/é€šçŸ¥"></a>6.3Conditionç±»å®ç°ç­‰å¾…/é€šçŸ¥</h3><p>å…³é”®å­— synchronized ä¸ wait()/notify()è¿™ä¸¤ä¸ªæ–¹æ³•ä¸€èµ·ä½¿ç”¨å¯ä»¥å®ç°ç­‰å¾…/é€šçŸ¥æ¨¡å¼ï¼Œ <strong>Lock é”çš„ newContition()æ–¹æ³•è¿”å› Condition å¯¹è±¡ï¼ŒCondition ç±» ä¹Ÿå¯ä»¥å®ç°ç­‰å¾…/é€šçŸ¥æ¨¡å¼</strong>ã€‚ ç”¨ notify()é€šçŸ¥æ—¶ï¼ŒJVM ä¼šéšæœºå”¤é†’æŸä¸ªç­‰å¾…çš„çº¿ç¨‹ï¼Œ ä½¿ç”¨ Condition ç±»å¯ä»¥ è¿›è¡Œé€‰æ‹©æ€§é€šçŸ¥ï¼Œ Condition æ¯”è¾ƒå¸¸ç”¨çš„ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li><strong>await()</strong>ï¼šä¼šä½¿å½“å‰çº¿ç¨‹ç­‰å¾…,åŒæ—¶ä¼šé‡Šæ”¾é”,å½“ç­‰åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨<code>signal()</code>æ–¹æ³•æ—¶,æ­¤æ—¶è¿™ä¸ªæ²‰ç¡çº¿ç¨‹ä¼šé‡æ–°è·å¾—é”å¹¶ç»§ç»­æ‰§è¡Œä»£ç ï¼ˆåœ¨å“ªé‡Œæ²‰ç¡å°±åœ¨å“ªé‡Œå”¤é†’ï¼‰ã€‚</li>
<li><strong>signal()</strong>ï¼šç”¨äºå”¤é†’ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹ã€‚</li>
</ul>
<p><code>æ³¨æ„</code>ï¼šåœ¨è°ƒç”¨ Condition çš„ await()/signal()æ–¹æ³•å‰ï¼Œä¹Ÿéœ€è¦çº¿ç¨‹æŒæœ‰ç›¸å…³ çš„ Lock é”ï¼Œè°ƒç”¨ await()åçº¿ç¨‹ä¼šé‡Šæ”¾è¿™ä¸ªé”ï¼Œåœ¨è°ƒç”¨singal()æ–¹æ³•åä¼šä»å½“å‰ Conditionå¯¹è±¡çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œåè¢«å”¤é†’çš„çº¿ç¨‹å¼€å§‹å°è¯•å»è·å¾—é”ï¼Œ ä¸€æ—¦æˆåŠŸè·å¾—é”å°±ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚</p>
<p>åœ¨è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­æ¥ç”¨ä»£ç å†™ä¸€ä¸‹ï¼š</p>
<p>ä¾‹å­ï¼šæˆ‘ä»¬æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œå®ç°å¯¹ä¸€ä¸ªåˆå§‹å€¼æ˜¯0çš„numberå˜é‡ï¼Œä¸€ä¸ªçº¿ç¨‹å½“number = =0æ—¶ å¯¹numberå€¼+1ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å½“number = = 1æ—¶å¯¹number-1ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Share</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">number</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">ReentrantLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Condition</span> <span class="variable">newCondition</span> <span class="operator">=</span> lock.newCondition();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// +1 çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">incr</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            lock.lock(); <span class="comment">// åŠ é”</span></span><br><span class="line">            <span class="keyword">while</span> (number != <span class="number">0</span>) &#123;</span><br><span class="line">                newCondition.await();<span class="comment">//æ²‰ç¡</span></span><br><span class="line">            &#125;</span><br><span class="line">            number++;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;::&quot;</span> + number);</span><br><span class="line">            newCondition.signal(); <span class="comment">//å”¤é†’å¦ä¸€ä¸ªæ²‰ç¡çš„çº¿ç¨‹ </span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// -1 çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">decr</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            lock.lock();</span><br><span class="line">            <span class="keyword">while</span> (number != <span class="number">1</span>) &#123;</span><br><span class="line">                newCondition.await();</span><br><span class="line">            &#125;</span><br><span class="line">            number--;</span><br><span class="line">            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;::&quot;</span> + number);</span><br><span class="line">            newCondition.signal();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LockDemo2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Share</span> <span class="variable">share</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Share</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">10</span>;i++)&#123;</span><br><span class="line">                share.incr();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,<span class="string">&quot;AA&quot;</span>).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">10</span>;i++)&#123;</span><br><span class="line">                share.decr();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,<span class="string">&quot;BB&quot;</span>).start();</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * AA::1</span></span><br><span class="line"><span class="comment">         * BB::0</span></span><br><span class="line"><span class="comment">         * AA::1</span></span><br><span class="line"><span class="comment">         * BB::0</span></span><br><span class="line"><span class="comment">         * .....</span></span><br><span class="line"><span class="comment">         */</span>     </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-4ReentrantLock-å¯é‡å…¥é”"><a href="#6-4ReentrantLock-å¯é‡å…¥é”" class="headerlink" title="6.4ReentrantLock(å¯é‡å…¥é”)"></a>6.4ReentrantLock(å¯é‡å…¥é”)</h3><blockquote>
<p>ReentrantLockæ˜¯å¯é‡å…¥é”ï¼Œæ˜¯å”¯ä¸€å®ç°äº†Lockæ¥å£çš„ç±»ï¼Œå¹¶ä¸”æä¾›äº†æ›´å¤šæ–¹æ³•</p>
<p>å¯é‡å…¥é”ï¼šæŸä¸ªçº¿ç¨‹å·²ç»è·å¾—æŸä¸ªé”ä¹‹åï¼Œå¯ä»¥å†æ¬¡è·å–é”è€Œä¸ä¼šå‡ºç°æ­»é”ç°è±¡</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReentrantLockDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ReentrantLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    lock.lock();</span><br><span class="line">                    System.out.println(<span class="string">&quot;ç¬¬1æ¬¡è·å–é”ï¼Œè¿™ä¸ªé”æ˜¯ï¼š&quot;</span> + lock);</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>;i&lt;=<span class="number">11</span>;i++)&#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            lock.lock();</span><br><span class="line">                            System.out.println(<span class="string">&quot;ç¬¬&quot;</span> + i + <span class="string">&quot;æ¬¡è·å–é”ï¼Œè¿™ä¸ªé”æ˜¯ï¼š&quot;</span> + lock);</span><br><span class="line">                            <span class="keyword">try</span> &#123;</span><br><span class="line">                                Thread.sleep(<span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">200</span>));</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                                e.printStackTrace();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                           lock.unlock();<span class="comment">// å¦‚æœæŠŠè¿™é‡Œæ³¨é‡Šæ‰çš„è¯ï¼Œé‚£ä¹ˆç¨‹åºå°±ä¼šé™·å…¥æ­»é”å½“ä¸­ã€‚</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    lock.unlock();<span class="comment">//ä½¿ç”¨Lockå¿…é¡»æ‰‹åŠ¨è§£é”</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line"></span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					lock.lock();</span><br><span class="line">                    System.out.println(<span class="string">&quot;è¿™é‡Œæ˜¯ä¸ºäº†æµ‹è¯•æ­»é”è€Œå¤šå†™ä¸€ä¸ªçš„çº¿ç¨‹&quot;</span>);</span><br><span class="line">				&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">					lock.unlock();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç¬¬1æ¬¡è·å–é”ï¼Œè¿™ä¸ªé”æ˜¯ï¼šjava.util.concurrent.locks.ReentrantLock@6b5fde1f[Locked by thread Thread-0]</span></span><br><span class="line"><span class="comment"> * ç¬¬2æ¬¡è·å–é”ï¼Œè¿™ä¸ªé”æ˜¯ï¼šjava.util.concurrent.locks.ReentrantLock@6b5fde1f[Locked by thread Thread-0]</span></span><br><span class="line"><span class="comment"> * ç¬¬3æ¬¡è·å–é”ï¼Œè¿™ä¸ªé”æ˜¯ï¼šjava.util.concurrent.locks.ReentrantLock@6b5fde1f[Locked by thread Thread-0]</span></span><br><span class="line"><span class="comment"> * ...</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<h3 id="6-5ReadWriteLockè¯»å†™é”"><a href="#6-5ReadWriteLockè¯»å†™é”" class="headerlink" title="6.5ReadWriteLockè¯»å†™é”"></a>6.5ReadWriteLockè¯»å†™é”</h3><blockquote>
<p>ReadWriteLockä¹Ÿæ˜¯ä¸€ä¸ªæ¥å£ï¼Œåœ¨å®ƒé‡Œé¢åªå®šä¹‰äº†ä¸¤ä¸ªæ¥å£</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ReadWriteLock</span> &#123;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// è·å–è¯»é”</span></span><br><span class="line">    Lock <span class="title function_">readLock</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// è·å–å†™é”</span></span><br><span class="line">    Lock <span class="title function_">writeLock</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ†ä¸ºä¸€ä¸ªè¯»é”ä¸€ä¸ªå†™é”ï¼Œå°†è¯»å†™è¿›è¡Œåˆ†ç¦»ï¼Œä½¿å¤šä¸ªçº¿ç¨‹å¯ä»¥åŒæ—¶è¿›è¡Œè¯»æ“ä½œï¼Œæé«˜æ•ˆç‡</p>
<p>ReentrantReadWriteLockå®ç°äº†ReadWriteLockæ¥å£ï¼Œæä¾›äº†æ›´ä¸°å¯Œçš„æ–¹æ³•ï¼Œå½“ç„¶æœ€ä¸»è¦çš„è¿˜æ˜¯è·å–è¯»å†™é”</p>
<blockquote>
<p>ä½¿ç”¨synchronizedå®ç°å¤šä¸ªçº¿ç¨‹å…±åŒè¯»æ“ä½œ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SynchronizedDemo2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">SynchronizedDemo2</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SynchronizedDemo2</span>();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            test.get(Thread.currentThread());</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            test.get(Thread.currentThread());</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">get</span><span class="params">(Thread thread)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">while</span>(System.currentTimeMillis() - start &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            System.out.println(thread.getName()+<span class="string">&quot;æ­£åœ¨è¿›è¡Œè¯»æ“ä½œ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(thread.getName()+<span class="string">&quot;è¯»æ“ä½œå®Œæ¯•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¾“å‡º</span></span><br><span class="line"><span class="comment"> * Thread-0æ­£åœ¨è¿›è¡Œè¯»æ“ä½œ</span></span><br><span class="line"><span class="comment"> * Thread-0è¯»æ“ä½œå®Œæ¯•</span></span><br><span class="line"><span class="comment"> * Thread-1æ­£åœ¨è¿›è¡Œè¯»æ“ä½œ</span></span><br><span class="line"><span class="comment"> * Thread-1æ­£åœ¨è¿›è¡Œè¯»æ“ä½œ</span></span><br><span class="line"><span class="comment"> * Thread-1æ­£åœ¨è¿›è¡Œè¯»æ“ä½œ</span></span><br><span class="line"><span class="comment"> * ....</span></span><br><span class="line"><span class="comment"> * Thread-1è¯»æ“ä½œå®Œæ¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä½¿ç”¨è¯»å†™é”å®ç°å¤šä¸ªçº¿ç¨‹å…±åŒè¯»æ“ä½œ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SynchronizedDemo2</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">ReentrantReadWriteLock</span> <span class="variable">rwl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantReadWriteLock</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">SynchronizedDemo2</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SynchronizedDemo2</span>();</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            test.get2(Thread.currentThread());</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            test.get2(Thread.currentThread());</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">get2</span><span class="params">(Thread thread)</span> &#123;</span><br><span class="line">        rwl.readLock().lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">            <span class="keyword">while</span>(System.currentTimeMillis() - start &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">                System.out.println(thread.getName()+<span class="string">&quot;æ­£åœ¨è¿›è¡Œè¯»æ“ä½œ&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(thread.getName()+<span class="string">&quot;è¯»æ“ä½œå®Œæ¯•&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            rwl.readLock().unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¾“å‡º</span></span><br><span class="line"><span class="comment"> * Thread-0æ­£åœ¨è¿›è¡Œè¯»æ“ä½œ</span></span><br><span class="line"><span class="comment"> * Thread-1æ­£åœ¨è¿›è¡Œè¯»æ“ä½œ</span></span><br><span class="line"><span class="comment"> * Thread-0è¯»æ“ä½œå®Œæ¯•</span></span><br><span class="line"><span class="comment"> * Thread-1è¯»æ“ä½œå®Œæ¯•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>ï¼ï¼ï¼æ³¨æ„ï¼š</strong></p>
<p><strong>1ã€è‹¥æ­¤æ—¶å·²ç»æœ‰ä¸€ä¸ªçº¿ç¨‹å ç”¨äº†è¯»é”ï¼Œæ­¤æ—¶å…¶ä»–çº¿ç¨‹ç”³è¯·è¯»é”æ˜¯å¯ä»¥çš„ï¼Œä½†å¦‚æœæƒ³ç”³è¯·å†™é”ï¼Œåˆ™å¿…é¡»ç­‰å¾…è¯»é”é‡Šæ”¾ï¼Œæ‰èƒ½æˆåŠŸè·å¾—</strong></p>
<p><strong>2ã€è‹¥æ­¤æ—¶å·²ç»æœ‰ä¸€ä¸ªçº¿ç¨‹å ç”¨äº†å†™é”ï¼Œæ­¤æ—¶å…¶ä»–çº¿ç¨‹ç”³è¯·è¯»é”è¿˜æ˜¯å†™é”éƒ½æ˜¯ä¸å…è®¸çš„ï¼Œåªæœ‰ç­‰å¾…æŒæœ‰å†™é”çš„çº¿ç¨‹é‡Šæ”¾é”ï¼Œæ‰èƒ½æˆåŠŸè·å¾—</strong></p>
</blockquote>
<h3 id="6-6synchronizedä¸Lockçš„åŒºåˆ«"><a href="#6-6synchronizedä¸Lockçš„åŒºåˆ«" class="headerlink" title="6.6synchronizedä¸Lockçš„åŒºåˆ«"></a>6.6synchronizedä¸Lockçš„åŒºåˆ«</h3><p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310142432950.png" alt="image-20240310142432950"></p>
<h2 id="7ã€é›†åˆçš„çº¿ç¨‹å®‰å…¨é—®é¢˜"><a href="#7ã€é›†åˆçš„çº¿ç¨‹å®‰å…¨é—®é¢˜" class="headerlink" title="7ã€é›†åˆçš„çº¿ç¨‹å®‰å…¨é—®é¢˜"></a>7ã€é›†åˆçš„çº¿ç¨‹å®‰å…¨é—®é¢˜</h2><blockquote>
<p>é—®é¢˜å¼•å…¥ï¼šè¿™æ®µç¨‹åºèƒ½çœ‹å‡ºé—®é¢˜å—ï¼Ÿ</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            list.add(UUID.randomUUID().toString());</span><br><span class="line">            System.out.println(list);</span><br><span class="line">        &#125;, <span class="string">&quot;çº¿ç¨‹&quot;</span> + i).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç­”ï¼šArrayListçš„addæ–¹æ³•å¹¶éçº¿ç¨‹åŒæ­¥çš„ï¼Œåœ¨è¯»å–listçš„æ—¶å€™åˆšå¥½é‡åˆ°å†™æ“ä½œï¼Œè¿™é‡Œæ²¡æœ‰åŒæ­¥ä»£ç å—ä»¥åŠåŠ é”ï¼Œä¼šæŠ¥<code>ConcurrentModificationException</code>çš„å¼‚å¸¸ï¼Œä¸­æ–‡åä¸ºï¼šå¹¶å‘ä¿®æ”¹å¼‚å¸¸</p>
<blockquote>
<p>è§£å†³æ–¹æ³•ï¼š</p>
</blockquote>
<blockquote>
<p>æ–¹å¼ä¸€ï¼šä½¿ç”¨vectoré›†åˆæ¥ä»£æ›¿ArrayList</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Vector</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            list.add(UUID.randomUUID().toString());</span><br><span class="line">            System.out.println(list);</span><br><span class="line">        &#125;, <span class="string">&quot;çº¿ç¨‹&quot;</span> + i).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>vectoræºä»£ç ä¸­addæ–¹æ³•æ˜¯æœ‰synchronizedå…³é”®å­—çš„ï¼Œæ˜¯åŒæ­¥æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> &#123;</span><br><span class="line">    modCount++;</span><br><span class="line">    add(e, elementData, elementCount);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ–¹å¼äºŒï¼šä½¿ç”¨Collections</p>
</blockquote>
<p>Collectionsæä¾›äº†æ–¹æ³•synchronizedListä¿è¯Listæ˜¯åŒæ­¥çš„ï¼Œçº¿ç¨‹å®‰å…¨çš„</p>
<p>Collectionsä»…åŒ…å«å¯¹é›†åˆè¿›è¡Œæ“ä½œæˆ–è¿”å›é›†åˆçš„é™æ€æ–¹æ³•ï¼Œä¹Ÿç§°ä¸ºé›†åˆçš„å·¥å…·ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> Collections.synchronizedList(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            list.add(UUID.randomUUID().toString());</span><br><span class="line">            System.out.println(list);</span><br><span class="line">        &#125;, <span class="string">&quot;çº¿ç¨‹&quot;</span> + i).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Collectionsæºç ä¸­addæ–¹æ³•åŒ…å«ä¸€ä¸ªåŒæ­¥ä»£ç å—ï¼Œå—ä¸­è°ƒç”¨listé›†åˆçš„addæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> &#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (mutex) &#123;list.add(index, element);&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ–¹å¼ä¸‰ï¼šä½¿ç”¨CopyOnWriteArrayListä»£æ›¿ArrayList</p>
</blockquote>
<blockquote>
<p>CopyOnWriteArrayList æ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ List é›†åˆï¼Œå®ƒé‡‡ç”¨äº†è¯»å†™åˆ†ç¦»çš„æ€æƒ³ï¼Œå³åœ¨å†™æ“ä½œæ—¶ï¼Œå…ˆå¤åˆ¶å½“å‰æ•°ç»„ï¼Œç„¶ååœ¨æ–°æ•°ç»„ä¸Šè¿›è¡Œå†™æ“ä½œï¼Œæœ€åé€šè¿‡æŒ‡å‘æ–°æ•°ç»„çš„æ–¹å¼å®Œæˆå¯¹è±¡çš„å¼•ç”¨ã€‚ç”±äºè¯»æ“ä½œæ— éœ€åŠ é”ï¼Œå› æ­¤è¯»å†™æ“ä½œå¹¶ä¸å†²çªã€‚</p>
</blockquote>
<p>CopyOnWriteArrayListæœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š</p>
<ul>
<li>æ›´æ–°æ“ä½œå¼€é”€å¤§ï¼ˆaddã€setã€removeï¼‰ï¼Œå› ä¸ºè¦å¤åˆ¶æ•´ä¸ªæ•°ç»„</li>
<li>è¯»å†™åˆ†ç¦»ï¼Œå†™æ“ä½œåŠ é”ï¼Œè¯»æ“ä½œæ— é¡»åŠ é”ï¼Œé€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯</li>
<li>åœ¨è¿­ä»£æ—¶å¯èƒ½å­˜åœ¨æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Œåœ¨è¿­ä»£è¿‡ç¨‹ä¸­åº”è¯¥é¿å…å¯¹é›†åˆè¿›è¡Œä¿®æ”¹</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CopyOnWriteArrayList</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            list.add(UUID.randomUUID().toString());</span><br><span class="line">            System.out.println(list);</span><br><span class="line">        &#125;, <span class="string">&quot;çº¿ç¨‹&quot;</span> + i).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸ºä»€ä¹ˆCopyOnWriteArrayListä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿ</p>
<p>ç­”ï¼š</p>
<p>1ã€åœ¨æ¶‰åŠåˆ°æ›´æ–°æ“ä½œæ—¶ï¼Œéƒ½ä¼šå¤åˆ¶å½“å‰æ•°ç»„ï¼Œåœ¨æ–°æ•°ç»„ä¸Šåšæ›´æ–°ï¼Œæœ€åå°†å¼•ç”¨æŒ‡å‘æ–°æ•°ç»„</p>
<p>2ã€ç”±volatileæ•°ç»„æ¥ä¿å­˜åŸæ•°ç»„çš„å¼•ç”¨ï¼Œä¿è¯è¯»çº¿ç¨‹å¯ä»¥è¯»å–åˆ°å†™çº¿ç¨‹æœ€æ–°æ›´æ–°å®Œæˆçš„æ•°æ®ï¼Œå³æ›´æ–°ä¹‹åæ•°æ®çš„åœ°å€å·²ç»æ”¹å˜ï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨volaliteå…³é”®å­—ä½¿å¾—è¯»çº¿ç¨‹å¯ä»¥é€šè¿‡valoliteæ•°ç»„å¾—åˆ°æ•°æ®æœ€æ–°çš„å¼•ç”¨</p>
<p>3ã€åœ¨æ›´æ–°æ“ä½œæ—¶ï¼Œéƒ½ä¼šç‡å…ˆå»è·å–äº’æ–¥é”ï¼Œ åœ¨ä¿®æ”¹å®Œæ¯•ä¹‹åï¼Œå…ˆå°†æ•°æ®æ›´æ–°åˆ°â€œvolatile æ•°ç»„â€ä¸­ï¼Œç„¶åå†â€œé‡Šæ”¾äº’æ–¥é”â€ï¼Œè¿™æ ·å°±èƒ½å¤Ÿä¿è¯æ•°æ®çš„å®‰å…¨</p>
<h2 id="8ã€Callableæ¥å£"><a href="#8ã€Callableæ¥å£" class="headerlink" title="8ã€Callableæ¥å£"></a>8ã€Callableæ¥å£</h2><blockquote>
<p>Callableç±»ä¼¼äºRunnableæ¥å£ï¼Œä½†Runnableæ¥å£ä¸­çš„run()æ–¹æ³•ä¸ä¼šè¿”å›ç»“æœï¼Œå¹¶ä¸”ä¹Ÿæ— æ³•æŠ›å‡ºç»è¿‡æ£€æŸ¥çš„å¼‚å¸¸ï¼Œä½†æ˜¯Callableæ¥å£ä¸­çš„call()æ–¹æ³•èƒ½å¤Ÿè¿”å›è®¡ç®—ç»“æœï¼Œå¹¶ä¸”ä¹Ÿèƒ½å¤ŸæŠ›å‡ºç»è¿‡æ£€æŸ¥çš„å¼‚å¸¸ã€‚</p>
</blockquote>
<h3 id="8-1Callableæ¥å£"><a href="#8-1Callableæ¥å£" class="headerlink" title="8.1Callableæ¥å£"></a>8.1Callableæ¥å£</h3><p><strong>é€šè¿‡å®ç°Callableæ¥å£åˆ›å»ºçº¿ç¨‹è¯¦ç»†æ­¥éª¤</strong>ï¼š</p>
<ol>
<li><p>åˆ›å»ºå®ç°Callableæ¥å£çš„ç±»SomeCallable</p>
</li>
<li><p>åˆ›å»ºä¸€ä¸ªç±»å¯¹è±¡ï¼šCallable oneCallable = new SomeCallable();</p>
</li>
<li><p>ç”±Callableåˆ›å»ºä¸€ä¸ªFutureTaskå¯¹è±¡ï¼šFutureTask futureTask= new FutureTask(oneCallable);</p>
<p>æ³¨é‡Šï¼šFutureTaskæ˜¯ä¸€ä¸ªåŒ…è£…å™¨ï¼Œå®ƒé€šè¿‡æ¥å—Callableæ¥åˆ›å»ºï¼Œå®ƒåŒæ—¶å®ç°äº†Futureå’ŒRunnableæ¥å£ã€‚</p>
</li>
<li><p>ç”±FutureTaskåˆ›å»ºä¸€ä¸ªThreadå¯¹è±¡ï¼šThread oneThread = new Thread(futureTask);</p>
</li>
<li><p>å¯åŠ¨çº¿ç¨‹ï¼šoneThread.start();</p>
</li>
</ol>
<p>è¿™é‡Œä¹‹æ‰€ä»¥è¦è½¬æˆ FutureTask æ”¾è¿› Threadä¸­å»ï¼Œæ˜¯å› ä¸ºCallable æœ¬èº«ä¸Threadæ²¡æœ‰å…³ç³»ï¼Œé€šè¿‡FutureTask æ‰èƒ½å’ŒThreadäº§ç”Ÿè”ç³»ã€‚</p>
<h3 id="8-2Futureæ¥å£"><a href="#8-2Futureæ¥å£" class="headerlink" title="8.2Futureæ¥å£"></a>8.2Futureæ¥å£</h3><blockquote>
<p>Futureæ¥å£æä¾›æ–¹æ³•æ¥æ£€æµ‹ä»»åŠ¡æ˜¯å¦è¢«æ‰§è¡Œå®Œï¼Œç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œè·å¾—ç»“æœï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä»»åŠ¡çš„è¶…æ—¶æ—¶é—´ã€‚è¿™ä¸ªè®¾ç½®è¶…æ—¶çš„æ–¹æ³•å°±æ˜¯å®ç°Javaç¨‹åºæ‰§è¡Œè¶…æ—¶çš„å…³é”®ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Future</span>&lt;V&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">cancel</span><span class="params">(<span class="type">boolean</span> mayInterruptIfRunning)</span>; <span class="comment">//å°è¯•å–æ¶ˆæ­¤ä»»åŠ¡çš„æ‰§è¡Œã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isCancelled</span><span class="params">()</span>;<span class="comment">//å¦‚æœæ­¤ä»»åŠ¡åœ¨æ­£å¸¸å®Œæˆä¹‹å‰è¢«å–æ¶ˆï¼Œåˆ™è¿”å›true </span></span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isDone</span><span class="params">()</span>; <span class="comment">//å¦‚æœæ­¤ä»»åŠ¡å®Œæˆï¼Œåˆ™è¿”å›true ã€‚ å®Œæˆå¯èƒ½æ˜¯ç”±äºæ­£å¸¸ç»ˆæ­¢ã€å¼‚å¸¸æˆ–å–æ¶ˆâ€”â€”åœ¨æ‰€æœ‰è¿™äº›æƒ…å†µä¸‹ï¼Œæ­¤æ–¹æ³•å°†è¿”å›true </span></span><br><span class="line"></span><br><span class="line">    V <span class="title function_">get</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException, ExecutionException; <span class="comment">//è·å¾—ä»»åŠ¡è®¡ç®—ç»“æœ</span></span><br><span class="line"></span><br><span class="line">    V <span class="title function_">get</span><span class="params">(<span class="type">long</span> timeout, TimeUnit unit)</span> </span><br><span class="line">        <span class="keyword">throws</span> InterruptedException, ExecutionException, TimeoutException;<span class="comment">//å¯ç­‰å¾…å¤šå°‘æ—¶é—´å»è·å¾—ä»»åŠ¡è®¡ç®—ç»“æœ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Futureæ¨¡å¼é€šä¿—ç‚¹æ¥æè¿°å°±æ˜¯ï¼šæˆ‘æœ‰ä¸€ä¸ªä»»åŠ¡ï¼Œæäº¤ç»™äº†Futureï¼ŒFutureæ›¿æˆ‘å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚æœŸé—´æˆ‘è‡ªå·±å¯ä»¥å»åšä»»ä½•æƒ³åšçš„äº‹æƒ…ã€‚ä¸€æ®µæ—¶é—´ä¹‹åï¼Œæˆ‘å°±ä¾¿å¯ä»¥<strong>ä»Futureé‚£å„¿å–å‡ºç»“æœ</strong>ã€‚</p>
<h3 id="8-3FutureTask"><a href="#8-3FutureTask" class="headerlink" title="8.3FutureTask"></a>8.3FutureTask</h3><blockquote>
<p>FutureTaskç±»æä¾›Futureçš„åŸºæœ¬å®ç°ï¼Œå…·æœ‰å¯åŠ¨å’Œå–æ¶ˆè®¡ç®—ï¼ŒæŸ¥çœ‹è®¡ç®—æ˜¯å¦å®Œæˆä»¥åŠæ£€ç´¢è®¡ç®—ç»“æœçš„æ–¹æ³•ã€‚è®¡ç®—å®Œæˆåæ‰å¯ä»¥æ£€ç´¢ç»“æœï¼›å¦‚æœè®¡ç®—å°šæœªå®Œæˆï¼Œgetæ–¹æ³•å°†é˜»å¡ã€‚ä¸€æ—¦è®¡ç®—å®Œæˆï¼Œå°±ä¸èƒ½é‡æ–°å¼€å§‹æˆ–å–æ¶ˆè®¡ç®—ï¼ˆé™¤éè°ƒç”¨runAndResetæ–¹æ³•è°ƒç”¨è®¡ç®—ï¼‰</p>
</blockquote>
<p><img src= "/img/loading.gif" data-src="https://qiniu.azkk.top/typora/image-20240310142459690.png" alt="image-20240310142459690"></p>
<p><strong>FutureTaskå®ç°äº† Runnable å’Œ Futureæ¥å£ï¼Œå¹¶æ–¹ä¾¿åœ°å°†ä¸¤ç§åŠŸèƒ½ç»„åˆåœ¨ä¸€èµ·ã€‚å¹¶ä¸”é€šè¿‡æ„é€ å‡½æ•°æä¾›Callableæ¥åˆ›å»ºFutureTaskï¼Œå°±å¯ä»¥æä¾›ç»™Threadæ¥åˆ›å»ºçº¿ç¨‹å•¦ã€‚</strong></p>
<p>FutureTaskæœ‰ä»¥ä¸‹ä¸‰ç§çŠ¶æ€ï¼š</p>
<ol>
<li>æœªå¯åŠ¨çŠ¶æ€ï¼šè¿˜æœªæ‰§è¡Œrunï¼ˆï¼‰æ–¹æ³•ã€‚</li>
<li>å·²å¯åŠ¨çŠ¶æ€ï¼šå·²ç»åœ¨æ‰§è¡Œrunï¼ˆï¼‰æ–¹æ³•ã€‚</li>
<li>å®ŒæˆçŠ¶æ€ï¼šå·²ç»æ‰§è¡Œå®Œrun()æ–¹æ³•ï¼Œæˆ–è€…è¢«å–æ¶ˆäº†ï¼Œäº¦æˆ–è€…æ–¹æ³•ä¸­å‘ç”Ÿå¼‚å¸¸è€Œå¯¼è‡´ä¸­æ–­ç»“æŸã€‚</li>
</ol>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<p>1ã€åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œæ¯”è¾ƒè€—æ—¶çš„æ“ä½œï¼Œä½†åŒæ—¶åˆä¸èƒ½å»é˜»å¡ä¸»çº¿ç¨‹æ—¶ï¼Œå°±å¯ä»¥å°†è¿™æ ·çš„ä»»åŠ¡äº¤ç»™FutureTaskå¯¹è±¡åœ¨åå°å®Œæˆï¼Œç„¶åç­‰å¾…ä¹‹åä¸»çº¿ç¨‹éœ€è¦çš„æ—¶å€™ï¼Œå†ç›´æ¥é€šè¿‡get()æ–¹æ³•æ¥è·å¾—è¿”å›æ•°æ®æˆ–è€…é€šè¿‡isDone()è·å¾—ä»»åŠ¡çŠ¶æ€ã€‚</p>
<p>2ã€ä¸€èˆ¬FutureTaskå¤šåº”ç”¨äºè€—æ—¶çš„è®¡ç®—ï¼Œè¿™æ ·ä¸»çº¿ç¨‹å°±å¯ä»¥æŠŠä¸€ä¸ªè€—æ—¶çš„ä»»åŠ¡äº¤ç»™FutureTaskï¼Œç„¶åç­‰åˆ°å®Œæˆè‡ªå·±çš„ä»»åŠ¡åï¼Œå†å»è·å–è®¡ç®—ç»“æœã€‚</p>
<p><strong>æ³¨æ„</strong>ï¼š</p>
<ul>
<li>ä»…åœ¨è®¡ç®—å®Œæˆæ—¶æ‰èƒ½æ£€ç´¢ç»“æœï¼›å¦‚æœè®¡ç®—å°šæœªå®Œæˆï¼Œåˆ™é˜»å¡ get æ–¹æ³•ã€‚</li>
<li>ä¸€æ—¦è®¡ ç®—å®Œæˆï¼Œå°±ä¸èƒ½å†é‡æ–°å¼€å§‹æˆ–å–æ¶ˆè®¡ç®—ã€‚</li>
<li>get æ–¹æ³•è€Œè·å–ç»“æœåªæœ‰åœ¨è®¡ç®—å®Œæˆæ—¶è·å–ï¼Œå¦åˆ™ä¼šä¸€ç›´é˜»å¡ç›´åˆ°ä»»åŠ¡è½¬å…¥å®ŒæˆçŠ¶æ€ï¼Œç„¶åä¼šè¿”å›ç»“æœæˆ–è€…æŠ›å‡ºå¼‚å¸¸ã€‚</li>
<li>å› ä¸ºåªä¼šè®¡ç®—ä¸€æ¬¡,å› æ­¤é€šå¸¸getæ–¹æ³•æ”¾åˆ°æœ€åã€‚</li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">AZ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://ch-azkk.github.io/posts/520502/">https://ch-azkk.github.io/posts/520502/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://ch-azkk.github.io" target="_blank">AZã®BLOG</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JUC/">JUC</a><a class="post-meta__tags" href="/tags/Java/">Java</a></div><div class="post_share"><div class="social-share" data-image="/img/project.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/520503/"><img class="prev-cover" data-src="/img/pdf.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">PDFå¤„ç†å·¥å…·æ¨è</div></div></a></div><div class="next-post pull-right"><a href="/posts/520505/"><img class="next-cover" data-src="/img/english.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">è‹±è¯­å­¦ä¹ </div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024  <i id="heartbeat" class="fa fas fa-heartbeat"></i> AZ</div><div class="framework-info"><span>é©±åŠ¨ </span><a target="_blank" rel="noopener" href="https://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></head></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script><script src="/js/calendar.js"></script><script src="/js/languages.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1.2,"jsonPath":"/live2dw/assets/hk416.model.json"},"display":{"width":200,"height":650,"position":"right","hOffset":0,"vOffset":-150},"mobile":{"show":true,"scale":0.5},"log":false});</script></body></html>